#!/command/with-contenv bashio
# ==============================================================================
# Take down the S6 supervision tree when the service fails
# ==============================================================================

declare exit_code
exit_code="${1}"

bashio::log.info "Service exited with code ${exit_code}"

if [[ "${exit_code}" -ne 0 ]] && [[ "${exit_code}" -ne 256 ]]; then
    bashio::log.warning "Service crashed with exit code ${exit_code}"
    bashio::addon.restart
fi
